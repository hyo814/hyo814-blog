---
title: React의 Fiber 아키텍처
date: '2024-01-12'
tags: [Fiber]
draft: false
summary: 'Fiber'
---

# React의 Fiber 아키텍처

React의 Fiber 아키텍처가 기존 Stack Reconciliation과 어떻게 다른지 설명하고, Fiber가 React의 비동기 렌더링을 가능하게 하는 방법을 구체적으로 설명하세요. 또한, Fiber 아키텍처의 작업 단위와 우선 순위 기반 작업 처리 방식이 성능 최적화에 어떤 기여를 하는지 설명해주세요.

​

질문의도 입니다!

​

React의 Fiber 아키텍처와 기존 Stack 기반 아키텍처의 차이점에 대한 깊이 있는 이해를 요구하며, 비동기 렌더링과 우선 순위 기반 작업 처리가 성능 최적화에 어떻게 기여하는지 논리적으로 설명할 수 있는지를 평가하려는 의도입니다.

---

React의 Fiber 아키텍처는 기존 Stack 기반 Reconciliation 방식에서 해결하기 어려웠던 성능 문제를 해결하고, 비동기 렌더링을 가능하게 만든 핵심적인 변화를 포함하고 있습니다.

### 1. **Stack Reconciliation vs. Fiber Reconciliation**

기존 Stack Reconciliation 방식에서는 컴포넌트 트리의 변경 사항을 한 번에 모두 탐색하고 처리합니다. 이 방식은 단일 스레드에서 동작하기 때문에, 큰 트리 구조에서 많은 업데이트가 발생하면 긴 시간 동안 메인 스레드가 점유되어 브라우저의 UI 응답성이 떨어질 수 있습니다. 이는 특히 애니메이션이나 사용자 인터랙션 중에 렌더링이 중단되는 문제를 일으킬 수 있었습니다.

**Fiber Reconciliation**은 이 문제를 해결하기 위해 도입된 아키텍처로, React는 업데이트를 **작은 작업 단위(Work Units)**로 나누어, 각 작업을 짧은 시간 동안 처리할 수 있게 만들었습니다. 이 작은 작업 단위는 일종의 "스레드처럼" 작동하며, 작업을 처리하는 도중 브라우저가 더 중요한 일을 처리할 수 있도록 제어권을 넘겨줍니다. 이렇게 **작업을 나누고 중단할 수 있는 구조**가 **비동기 렌더링**을 가능하게 하는 핵심입니다.

### 2. **비동기 렌더링의 동작 원리**

Fiber는 **작업 단위**로 나누어진 각 업데이트를 일정 시간이 지나면 멈추고, **우선순위가 더 높은 작업**(예: 사용자 인터랙션이나 애니메이션)을 처리할 수 있도록 합니다. 이를 통해 React는 다음과 같은 방식으로 비동기 렌더링을 처리합니다:

- **Time Slicing**: React는 작업을 일정한 시간 동안만 처리하고, 남은 작업은 나중에 처리할 수 있도록 대기시킵니다. 이렇게 시간 조각을 나누어 사용하는 방식은 애플리케이션이 장시간 메인 스레드를 점유하는 것을 방지하고, 브라우저가 사용자의 입력이나 UI 업데이트에 빠르게 반응할 수 있게 합니다.
- **Interruption and Resuming**: Fiber는 작업이 완료되기 전에 중단될 수 있고, 언제든 다시 작업을 재개할 수 있습니다. 이를 통해 무거운 작업도 UI가 중단 없이 반응할 수 있도록 처리됩니다.

### 3. **Fiber의 작업 단위와 우선순위 기반 처리 방식**

Fiber는 **우선 순위 기반**으로 작업을 처리합니다. 각 작업 단위는 중요도에 따라 우선순위를 부여받으며, 이를 바탕으로 더 중요한 작업을 먼저 처리하고, 덜 중요한 작업은 나중에 처리합니다. 이 우선순위 체계는 성능 최적화에 크게 기여합니다:

- **Immediate Priority**: 사용자 입력과 같이 즉시 반응해야 하는 작업.
- **High Priority**: 애니메이션이나 UI 업데이트와 같은 작업.
- **Low Priority**: 데이터 패칭이나 화면 외부의 비동기 작업 등 상대적으로 덜 중요한 작업.

React는 이러한 우선순위를 통해 중요한 작업을 먼저 처리함으로써, 애플리케이션의 **사용자 경험**이 부드럽고 반응성 있게 유지되도록 합니다.

### 4. **성능 최적화 기여**

- **스레드 블로킹 방지**: Stack Reconciliation과 달리, Fiber는 메인 스레드를 독점하지 않고 브라우저가 다른 작업을 수행할 기회를 제공합니다. 이로 인해 애플리케이션이 큰 작업을 처리할 때도 UI가 부드럽게 동작합니다.
- **우선순위 기반 처리**: 사용자에게 즉각적으로 필요한 UI 업데이트는 빠르게 처리하고, 나머지 덜 중요한 작업은 나중에 처리할 수 있어, 전체적인 성능을 최적화합니다.
- **비동기성**: Fiber가 작업을 분할하고, 중단 후 다시 재개할 수 있기 때문에, 긴 작업이 있어도 애플리케이션의 반응성에 큰 영향을 주지 않습니다.

### 결론

React의 Fiber 아키텍처는 **작업 단위의 분할**과 **우선순위 기반 처리**를 통해 기존 Stack 기반 방식이 가진 성능 한계를 극복했습니다. 이로 인해 비동기 렌더링이 가능해졌고, UI 응답성을 유지하면서도 복잡한 렌더링 작업을 효율적으로 처리할 수 있게 되었습니다. Fiber는 성능 최적화 측면에서 React 애플리케이션의 사용자 경험을 크게 향상시킵니다.

---

### 1. 서론

React는 UI를 효율적으로 관리하고 업데이트하기 위한 강력한 라이브러리로, 최근 몇 년 동안 그 성능을 대폭 개선해왔습니다. 특히 **Fiber 아키텍처**가 도입되면서 React는 비동기 렌더링과 우선순위 기반 작업 처리를 통해 UI 성능을 크게 향상시켰습니다. 이번 글에서는 React의 Fiber 아키텍처가 기존 Stack 기반 Reconciliation 방식과 어떻게 다른지, 그리고 Fiber가 성능 최적화에 어떤 기여를 하는지에 대해 깊이 있게 알아보겠습니다.

---

### 2. 기존 Stack 기반 Reconciliation

React는 컴포넌트 트리 구조를 기반으로 UI를 업데이트하는데, 이 과정에서 **Reconciliation**을 수행합니다. Reconciliation은 컴포넌트 트리의 변경 사항을 비교하고, 그에 맞춰 실제 DOM을 업데이트하는 과정입니다.

과거에는 이 작업이 **Stack 기반**으로 처리되었습니다. Stack 기반 방식에서는 컴포넌트 트리의 변화가 발생하면 이를 한 번에 처리하게 되는데, 문제는 이 작업이 단일 스레드에서 동작한다는 점입니다. 트리가 복잡하거나 변경사항이 많을 경우, React가 긴 시간 동안 메인 스레드를 점유하여 **브라우저의 UI 응답성**이 떨어질 수 있습니다. 이로 인해 애니메이션이나 사용자 인터랙션이 부드럽지 못하거나, 업데이트가 지연되는 문제가 발생했습니다.

---

### 3. Fiber 아키텍처의 등장

**Fiber 아키텍처**는 이러한 문제를 해결하기 위해 도입되었습니다. Fiber는 Stack 기반 Reconciliation의 단점을 보완하여 작업을 작은 단위로 쪼개서 처리할 수 있는 구조를 제공하며, 이로 인해 작업을 중단하고 나중에 재개하는 방식, 즉 **비동기 렌더링**이 가능해졌습니다.

### Fiber의 핵심 개념

- **작업 단위(Work Units)**: Fiber는 컴포넌트 트리의 변경사항을 작은 작업 단위로 쪼개어 처리합니다. 이를 통해 React는 한 번에 모든 작업을 처리하는 것이 아니라, 일정 시간 동안 작업을 수행한 후 필요하면 작업을 중단하고 브라우저에게 제어권을 넘깁니다.
- **중단 및 재개(Interruption and Resuming)**: Fiber는 작업 중 언제든지 중단될 수 있고, 나중에 다시 재개될 수 있습니다. 이를 통해 React는 사용자 인터랙션이나 중요한 UI 업데이트를 먼저 처리하고, 덜 중요한 작업은 나중으로 미루는 방식으로 동작합니다.

---

### 4. 비동기 렌더링의 동작 방식

Fiber 아키텍처는 **비동기 렌더링**을 가능하게 합니다. 비동기 렌더링은 작업이 긴 시간 동안 메인 스레드를 점유하지 않도록 작업을 작은 단위로 쪼개어, 일정 시간이 지나면 작업을 중단하고 브라우저의 다른 작업(예: 애니메이션, 사용자 인터랙션)을 처리할 수 있게 하는 방식입니다.

- **Time Slicing**: Fiber는 작업을 일정 시간 동안만 처리하고, 남은 작업은 다음 렌더 사이클로 넘깁니다. 이 방식은 메인 스레드를 지속적으로 점유하지 않기 때문에, UI가 중단 없이 동작할 수 있습니다.
- **Interruption and Resuming**: 긴 작업도 중단 후 재개할 수 있으므로, 중요한 작업을 먼저 처리하고 덜 중요한 작업은 나중에 처리합니다. 이렇게 하면 복잡한 컴포넌트 트리에서도 UI 성능이 저하되지 않습니다.

---

### 5. 우선순위 기반 작업 처리

Fiber는 각 작업 단위에 **우선순위**를 부여하여, 더 중요한 작업을 먼저 처리할 수 있도록 합니다. React는 사용자가 인터랙션을 했을 때 이 작업을 즉각적으로 처리하여 **즉시 반응성**을 유지하고, 덜 중요한 작업은 나중에 처리합니다.

### 우선순위 종류

- **Immediate Priority**: 즉각적인 처리가 필요한 사용자 입력이나 이벤트.
- **High Priority**: UI 업데이트나 애니메이션과 같이 즉각적인 반응이 필요한 작업.
- **Low Priority**: 데이터 패칭이나 화면 외부의 비동기 작업처럼 즉각적이지 않은 작업.

이렇게 우선순위를 기반으로 처리할 작업을 정하면, 중요한 UI 업데이트가 지연되지 않고 빠르게 처리되어 **성능 최적화**에 기여하게 됩니다.

---

### 6. 성능 최적화에 대한 Fiber의 기여

Fiber 아키텍처는 Stack 기반 방식에서 발생하던 UI 응답성 저하 문제를 해결하여, React 애플리케이션의 성능을 크게 향상시켰습니다. 특히 다음과 같은 방식으로 성능 최적화를 실현합니다:

- **스레드 블로킹 방지**: Stack 기반에서는 긴 작업이 메인 스레드를 독점하였지만, Fiber는 메인 스레드를 일정 시간 점유한 후 다른 작업을 처리할 수 있도록 제어권을 넘깁니다. 이를 통해 UI가 중단 없이 부드럽게 동작할 수 있습니다.
- **우선순위 기반 처리**: 사용자에게 중요한 작업을 먼저 처리하고, 덜 중요한 작업은 나중에 처리함으로써 **반응성 있는 UI**를 유지할 수 있습니다.
- **비동기 작업 처리**: 긴 작업을 분할하여 처리함으로써, 복잡한 작업이 있어도 애플리케이션의 반응성을 유지할 수 있습니다.

---

### 7. 결론

React의 **Fiber 아키텍처**는 기존 Stack 기반 방식에서 발생했던 성능 문제를 해결하고, 비동기 렌더링과 우선순위 기반 작업 처리를 통해 더욱 부드럽고 반응성 있는 UI를 구현할 수 있게 했습니다. Fiber는 성능 최적화를 위한 중요한 기술적 진보로, 대규모 애플리케이션에서도 React가 원활하게 동작할 수 있도록 돕습니다. React 개발자라면 이 Fiber의 동작 원리와 장점을 이해하고, 이를 바탕으로 효율적인 UI 성능 최적화를 이룰 수 있습니다.

---

**참고자료**

- [React Fiber Architecture](https://reactjs.org/docs/faq-internals.html)
- [Understanding React Fiber](https://blog.isquaredsoftware.com/presentations/2018-02-react-fiber-in-depth/#/)
