---
title:웹 브라우저 렌더링 과정과 성능 최적화 기법
date: '2023-03-19'
tags: [웹 성능]
draft: false
summary: '웹 브라우저 렌더링 과정과 성능 최적화 기법'
---

# 웹 브라우저 렌더링 과정과 성능 최적화 기법

웹 브라우저의 렌더링 과정을 설명하고, 렌더링 성능을 저하시킬 수 있는 요소들은 어떤 것이 있나요? 그리고 레이아웃 시프트(Layout Shift)와 페인트(Paint) 과정에서 발생하는 문제를 해결하기 위해 사용할 수 있는 최적화 기법들을 설명해주세요.

​

질문의도 입니다!

​

웹 브라우저의 렌더링 과정을 깊이 이해하고, 성능 저하의 원인이 되는 레이아웃 시프트나 페인트 과정에서 발생할 수 있는 문제를 어떻게 해결하는지를 평가합니다. 특히, 브라우저의 렌더링 성능 최적화 기법(CSS 최적화, 애니메이션의 GPU 활용, 이미지의 크기 및 포맷 최적화 등)을 제시할 수 있는지를 확인하는 문제입니다.

---

웹 브라우저의 렌더링 과정은 크게 다음과 같은 단계로 나눌 수 있습니다:

### 1. **HTML 파싱 및 DOM 트리 생성**

브라우저는 HTML 파일을 읽고 이를 파싱하여 DOM(Document Object Model) 트리를 생성합니다. DOM은 HTML 요소 간의 계층 구조를 표현한 트리입니다.

### 2. **CSSOM 생성**

브라우저는 CSS를 파싱하여 CSSOM(CSS Object Model) 트리를 만듭니다. CSSOM은 DOM과 유사하게 CSS 규칙을 기반으로 한 객체 모델입니다.

### 3. **렌더 트리 생성**

DOM과 CSSOM을 결합하여 렌더 트리를 만듭니다. 이 렌더 트리는 브라우저가 실제로 화면에 표시할 요소들만 포함하며, `display: none`과 같은 요소들은 제외됩니다.

### 4. **레이아웃 (Reflow)**

렌더 트리가 생성되면 각 요소의 크기와 위치를 계산하는 레이아웃 과정이 실행됩니다. 브라우저는 뷰포트의 크기와 콘텐츠의 특성에 맞게 각 요소의 위치를 설정합니다.

### 5. **페인트(Paint)**

레이아웃이 완료되면 요소들을 실제 픽셀 단위로 화면에 그리는 과정인 페인트 단계가 진행됩니다. 색상, 텍스처, 그림자 등 시각적 스타일이 적용됩니다.

### 6. **합성(Composite)**

각 레이어를 독립적으로 그린 후, GPU를 이용해 이들을 합성하여 최종적으로 화면에 표시합니다. 이 과정에서 애니메이션 처리 등이 포함될 수 있습니다.

---

### **렌더링 성능 저하의 요소**

1. **레이아웃 시프트(Layout Shift)**

   레이아웃 시프트는 화면에 표시된 요소들이 사용자가 보는 도중에 예기치 않게 이동하는 현상입니다. 이로 인해 사용 경험이 저하될 수 있으며, **Cumulative Layout Shift(CLS)** 메트릭으로 측정됩니다.

2. **자주 발생하는 레이아웃(Reflow)**
   DOM 변경으로 인해 레이아웃을 반복적으로 재계산하면 성능이 크게 저하됩니다. 자바스크립트에서 DOM을 조작하거나 크기를 변경하는 동작이 있을 때 레이아웃이 다시 계산되기 때문에 이를 최소화해야 합니다.
3. **자주 발생하는 페인트(Paint)**
   레이아웃과 유사하게 자주 페인트가 발생하면 성능이 저하됩니다. CSS 변경, 스타일 재적용, 이미지 크기 변경 등이 원인이 될 수 있습니다.
4. **복잡한 애니메이션**
   애니메이션이 CPU에서 처리되면 성능이 저하될 수 있습니다. 특히, `transform`, `opacity` 외의 속성을 애니메이션하면 레이아웃과 페인트가 자주 발생해 성능 저하를 일으킵니다.

---

### **레이아웃 시프트와 페인트 최적화 기법**

1.  **CLS 최소화를 위한 이미지 크기 고정**
    이미지가 로드되는 동안 크기가 변하지 않도록 너비와 높이를 미리 정의합니다. 이로 인해 레이아웃 시프트가 줄어듭니다.
        ```html
        <img src="example.jpg" width="400" height="300" />

        ```
2.  **폰트 로딩 최적화**
    웹폰트를 로드하는 동안 텍스트가 갑자기 변경되는 것을 방지하기 위해 `font-display: swap` 속성을 사용해 시스템 폰트를 먼저 표시하고 나중에 웹폰트를 적용하는 방법을 사용할 수 있습니다.
3.  **CSS 최적화**
    - **사용하지 않는 CSS 제거**: 불필요한 CSS 파일은 렌더링 성능을 저하시킬 수 있으므로 코드에서 사용되지 않는 CSS를 제거합니다.
    - **애니메이션을 GPU로 오프로드**: 애니메이션 성능을 높이기 위해 CSS 애니메이션에서 `transform`과 `opacity`만을 애니메이션하여 GPU가 이를 처리하게끔 할 수 있습니다.
4.  **이미지 최적화**
    - **이미지 포맷 최적화**: 웹에서 이미지 파일 크기를 줄이기 위해 WebP와 같은 최적화된 이미지 포맷을 사용합니다.
    - **적응형 이미지**: 반응형 디자인을 적용할 때 화면 크기에 맞게 이미지 크기를 동적으로 조절하는 기법을 사용해 불필요한 데이터 전송을 줄입니다.
5.  **RequestAnimationFrame 활용**
    애니메이션을 구현할 때 `requestAnimationFrame`을 사용해 브라우저가 최적의 타이밍에 애니메이션을 실행하도록 하여 부드럽게 처리할 수 있습니다. 이를 통해 렌더링 주기를 효율적으로 사용할 수 있습니다.
        ```jsx
        function animate() {
          requestAnimationFrame(animate);
          // 애니메이션 코드
        }
        animate();

        ```
6.  **레이아웃 변경 최소화**
    DOM 조작이 필요한 경우, 한 번의 큰 변경으로 해결하도록 하고, 연속된 작은 변경을 피하는 것이 좋습니다. 또한, `documentFragment`를 사용해 여러 DOM 조작을 한 번에 적용할 수 있습니다.

이러한 방법들은 브라우저의 렌더링 성능을 최적화하고, 사용자 경험을 개선하는 데 효과적입니다. 특히 레이아웃 시프트와 페인트 과정에서 발생하는 성능 저하 문제를 해결할 수 있는 중요한 최적화 기법들입니다.

---

### 1. 웹 브라우저의 렌더링 과정

웹 브라우저가 HTML 파일을 받아 화면에 출력하는 과정은 여러 단계로 이루어집니다. 이 과정을 이해하는 것은 성능 최적화에 매우 중요합니다.

- **HTML 파싱 및 DOM 트리 생성**: 브라우저는 HTML 문서를 파싱하여 DOM 트리를 만듭니다. DOM은 HTML의 요소들을 객체 모델로 표현한 트리입니다.
- **CSS 파싱 및 CSSOM 트리 생성**: CSS 파일을 파싱하여 CSSOM 트리를 생성합니다. 이는 스타일 정보를 포함한 객체 트리입니다.
- **렌더 트리 생성**: DOM과 CSSOM을 결합하여 화면에 실제로 그려질 요소들만 포함한 렌더 트리를 생성합니다.
- **레이아웃(Reflow)**: 렌더 트리를 기반으로 요소들의 크기와 위치를 계산하는 과정입니다.
- **페인트(Paint)**: 요소들을 실제 픽셀로 그려 화면에 표시합니다.
- **합성(Composite)**: GPU를 활용해 각 레이어를 합성하여 최종 화면에 출력합니다.

---

### 2. 성능 저하를 유발하는 요소

렌더링 과정 중 성능 저하의 원인이 되는 요소들을 이해해야, 그에 맞는 최적화 방법을 적용할 수 있습니다.

- **레이아웃 시프트(Layout Shift)**: 페이지 로드 중 또는 사용자 상호작용 중에 콘텐츠가 예기치 않게 이동하는 현상입니다.
- **빈번한 레이아웃 재계산(Reflow)**: DOM 변경으로 인해 레이아웃이 자주 다시 계산되면 성능 저하를 유발합니다.
- **자주 발생하는 페인트(Paint)**: 스타일 변경이나 레이아웃 재계산이 빈번할 때 페인트 작업이 많아져 성능에 영향을 줍니다.
- **복잡한 애니메이션**: `transform`이나 `opacity`가 아닌 속성에서 애니메이션이 발생하면 CPU 사용량이 높아집니다.

---

### 3. 레이아웃 시프트 및 페인트 최적화 기법

### **1) CLS(Cumulative Layout Shift) 최소화**

- **이미지 크기 고정**: 이미지를 로드하기 전에 크기를 미리 정의하여 레이아웃 변경을 방지합니다.
  ```html
  <img src="image.jpg" width="400" height="300" />
  ```
- **폰트 로딩 최적화**: 텍스트 로딩 중 레이아웃 시프트를 방지하려면 `font-display: swap`을 사용해 먼저 시스템 폰트를 보여준 후, 웹폰트가 로드되면 교체하는 방식을 적용합니다.

### **2) CSS 최적화**

- **불필요한 CSS 제거**: 사용하지 않는 CSS 파일은 렌더링 성능을 저하시킬 수 있으므로 이를 제거합니다.
- **애니메이션 최적화**: `transform`과 `opacity`만을 애니메이션하여 GPU가 이를 처리하게 합니다. GPU를 활용한 애니메이션은 성능에 큰 도움을 줍니다.

### **3) 이미지 최적화**

- **이미지 포맷 최적화**: WebP와 같은 최적화된 포맷을 사용해 이미지 크기를 줄입니다.
- **적응형 이미지 사용**: 다양한 화면 크기에 맞게 최적화된 이미지 크기를 제공하여 불필요한 데이터 전송을 줄입니다.

### **4) DOM 조작 최소화**

- **큰 단위로 DOM 변경**: DOM을 자주 변경하면 레이아웃이 자주 재계산됩니다. 한 번에 변경 작업을 적용하는 것이 효율적입니다.

### **5) RequestAnimationFrame 사용**

애니메이션 코드를 `requestAnimationFrame` 안에 넣어 브라우저의 렌더링 주기에 맞추어 부드러운 애니메이션을 구현할 수 있습니다.

```jsx
function animate() {
  requestAnimationFrame(animate)
  // 애니메이션 처리
}
animate()
```

### 마무리

웹 브라우저의 렌더링 과정을 이해하고, 성능 저하를 유발하는 요인들을 줄이는 것이 프론트엔드 개발에서 중요한 과제입니다. 특히 레이아웃 시프트나 빈번한 페인트 문제를 해결하기 위한 최적화 기법들을 잘 활용한다면, 더욱 부드럽고 빠른 사용자 경험을 제공할 수 있습니다.
